<html xmlns="http://www.w3.org/1999/xhtml" 
      xmlns:h="http://xmlns.jcp.org/jsf/html" 
      xmlns:f="http://xmlns.jcp.org/jsf/core" 
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets" 
      xmlns:jsf="http://xmlns.jcp.org/jsf" 
      xmlns:gc="http://xmlns.jcp.org/jsf/composite/gc">
    <ui:composition template="../template/template.xhtml">
        <ui:define name="content">
            <h:form  class="form-horizontal">
                <div class="panel panel-primary">
                    <div class="panel-body">
                        <ul class="nav nav-tabs" role="tablist">
                        <li role="presentation" class="active">
                            <a jsf:action="#{reporteSimcoController.cargarReporteCaso()}" aria-controls="home" role="tab" data-toggle="tab">
                                <span class="text-resalt-comun"/>Reporte de casos
                            </a>
                        </li>
                        <li role="presentation">
                            <a  jsf:action="#{reporteSimcoController.cargarReporteActor()}" aria-controls="profile" role="tab" data-toggle="tab">
                                <span class="text-resalt-comun"/>Reporte de actores
                            </a>
                        </li>
                        <li role="presentation">
                            <a jsf:action="#{actorController.cargarPaginaEntidad()}" aria-controls="messages" role="tab" data-toggle="tab">
                                <span class="glyphicon glyphicon-user" style="font-size:medium"/>
                                <span class="text-resalt-comun"/>Entidad estatal
                            </a>
                        </li>
                    </ul>
                        <div class="tab-content">
                            <div role="tabpanel" class="tab-pane active" id="home">
                        <table style="width: 100%">
                            <tr>
                                <td style="width: 50%">
                                    <style>
                                        td{
                                            padding-bottom: 7px;
                                        }
                                    </style>
                                    <table>
                                        <tr>
                                            <td>
                                                <b>Año:</b>
                                            </td>
                                            <td>
                                                <h:selectOneMenu value="#{reporteSimcoController.reporteSimco.anho}">
                                                    <f:selectItem itemLabel="Seleccione" itemValue="0" />
                                                    <f:selectItems value="#{reporteSimcoController.listaAnhos}" />
                                                </h:selectOneMenu>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <b>Tipología del caso</b>
                                            </td>
                                            <td>
                                                <h:selectOneMenu value="#{reporteSimcoController.reporteSimco.tipologia}">
                                                    <f:selectItem itemLabel="Seleccione" itemValue="0"/>
                                                    <f:selectItems value="#{listasComunesController.buscarTipoCaso(false, false, false)}" var="y" itemLabel="#{y.nombreParametro}" itemValue="#{y.valorParametro}" />
                                                </h:selectOneMenu>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <b>Región del caso</b>
                                            </td>
                                            <td>
                                                <h:selectOneMenu value="#{reporteSimcoController.reporteSimco.idRegion}" >
                                                    <f:selectItem itemLabel="Seleccione" itemValue="0"/>
                                                    <f:selectItems value="#{casoController.listaDepartamento}" var="y" itemLabel="#{y.value}" itemValue="#{y.label}" />
                                                </h:selectOneMenu>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <b>Estado del caso</b>
                                            </td>
                                            <td>
                                                <h:selectOneMenu value="#{reporteSimcoController.reporteSimco.estado}">
                                                    <f:selectItem itemLabel="Seleccione" itemValue="0"/>
                                                    <f:selectItems value="#{listasComunesController.buscarEstadoCaso(false, false, false)}" var="y" itemLabel="#{y.nombreParametro}" itemValue="#{y.valorParametro}" />
                                                </h:selectOneMenu>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <b>Que incluya este tipo de aconteciminento</b>
                                            </td>
                                            <td>
                                                <h:selectOneMenu value="#{reporteSimcoController.reporteSimco.tipoAcontecimiento}">
                                                    <f:selectItem itemLabel="Seleccione" itemValue="0"/>
                                                    <f:selectItems value="#{listasComunesController.buscarTipoAcontecimiento(false,false,false)}" var="y" itemLabel="#{y.nombreParametro}" itemValue="#{y.valorParametro}" />
                                                </h:selectOneMenu>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <b>Que incluyan como actor a comunidades nativas</b>
                                            </td>
                                            <td>
                                                <h:selectOneMenu value="#{reporteSimcoController.reporteSimco.esComunidadNativa}">
                                                    <f:selectItem itemLabel="Seleccione" itemValue="0"/>
                                                    <f:selectItem itemLabel="Si" itemValue="S"/>
                                                    <f:selectItem itemLabel="No" itemValue="N"/>
                                                </h:selectOneMenu>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><b>Actor involucrado</b></td>
                                            <td>
                                                <table style="width: 100%">
                                                    <tr>
                                                        <td style="width: 95%">
                                                            <input type="text" jsf:value="#{reporteSimcoController.reporteSimco.nombreActor}" placeholder="Actor" readonly="true" style="background: silver"/>
                                                            <h:inputHidden value="#{reporteSimcoController.reporteSimco.idActor}" />
                                                        </td>
                                                        <td>
                                                            <a class="btn btn-info" jsf:action="#{actorController.limpiarModalBusquedaActor()}">
                                                                <span class="glyphicon glyphicon-search" />Buscar
                                                                <f:ajax render="idPanelModalActor" onevent="openModalBusquedaActor()" />
                                                            </a>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><b>Tipo de actor </b></td>
                                            <td>
                                                <h:selectOneMenu value="#{reporteSimcoController.reporteSimco.tipoActor}">
                                                    <f:selectItem itemLabel="Seleccione" itemValue="NN"/>
                                                    <f:selectItem itemLabel="Población" itemValue="PE"/>
                                                    <f:selectItem itemLabel="Organización / empresa" itemValue="EM"/>
                                                    <f:selectItem itemLabel="Entidad estatal" itemValue="EN"/>
                                                </h:selectOneMenu>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><b>Inversión involucrada</b></td>
                                            <td></td>
                                        </tr>

                                    </table>
                                </td>
                                <td style="vertical-align: top; text-align: right">
                                    <a class="btn btn-warning" jsf:action="#{reporteSimcoController.limpiar()}">
                                        <span class="glyphicon glyphicon-asterisk" />Limpiar  
                                    </a>
                                    &#160;&#160;&#160;
                                    <a class="btn btn-primary" jsf:action="#{reporteSimcoController.reporteCasos()}">
                                        <span class="glyphicon glyphicon-search" />Buscar  
                                    </a>
                                </td>
                            </tr>
                        </table>
                        <br/>
                        <h:dataTable value="#{reporteSimcoController.listReporteCasos}" var="item" class="table table-striped" rendered="#{reporteSimcoController.listReporteCasos.size() > 0}">
                            <h:column>
                                <f:facet name="header">Código del Caso</f:facet>
                                <h:outputText value="#{item.codigoCaso}" />
                            </h:column>
                            <h:column>
                                <f:facet name="header">Nombre del Caso</f:facet>
                                <h:outputText value="#{item.nombreCaso}" />
                            </h:column>
                            <h:column>
                                <f:facet name="header">Fecha inicio</f:facet>
                                <h:outputText value="#{item.fechaInicioCaso}" />
                            </h:column>
                            <h:column>
                                <f:facet name="header">Region Principal</f:facet>
                                <h:outputText value="#{item.regionPrincial}" />
                            </h:column>
                            <h:column>
                                <f:facet name="header">Tipología</f:facet>
                                <h:outputText value="#{item.tipologia}" />
                            </h:column>
                            <h:column>
                                <f:facet name="header">Actividad</f:facet>
                                <h:outputText value="#{item.actividad}" />
                            </h:column>
                            <h:column>
                                <f:facet name="header">Estado</f:facet>
                                <h:outputText value="#{item.estado}" />
                            </h:column>
                            <h:column>
                                <f:facet name="header">Fase</f:facet>
                                <h:outputText value="#{item.fase}" />
                            </h:column>
                            <h:column>
                                <f:facet name="header">Acuerdos registrados</f:facet>
                                <h:outputText value="#{item.acuerdos == null? 0 : item.acuerdos}" />
                            </h:column>
                        </h:dataTable>
                    </div>
                </div>

                <div class="modal fade" tabindex="-1" role="dialog" id="idModalBusquedaActor">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true" class="glyphicon glyphicon-remove" style="color: red"/>
                                </button>
                                <span class="modal-title text-resalt-primary">Búsqueda de actor</span>
                            </div>
                            <div class="modal-body">
                                <h:panelGroup id="idPanelModalActor">
                                    <div id="idDivRegistro" class="form-group has-feedback" style="width:100%;margin:auto">
                                        <input type="text" name="nombreActor" placeholder="Buscar por nombre de actor"/>
                                        <a style="float:right;font-size:large;margin:auto" jsf:action="#{actorController.buscarActorXnombrePaginado(1)}" jsf:onclick="loadingModal()">
                                            <span class="glyphicon glyphicon-search form-control-feedback"/>
                                            <f:ajax render="idPanelModalActor" execute="@form" onevent="closeModal"/>
                                        </a>
                                    </div>
                                    <br/>
                                    <h:dataTable value="#{actorController.listaActorBusquedaGeneral}" rendered="#{actorController.listaActorBusquedaGeneral.size() > 0}" var="item" class="table table-striped" style="font-size:small" binding="#{row}">
                                        <h:column>
                                            <f:facet name="header">N.°</f:facet>
                                            <h:outputText value="#{(actorController.nroPagina-1)*10+row.rowIndex+1}" />
                                        </h:column>
                                        <h:column>
                                            <f:facet name="header">Nombres</f:facet>
                                            <h:outputText value="#{item.nombre} #{item.apellidoPat} #{item.apellidoMat}" />
                                        </h:column>
                                        <h:column>
                                            <f:facet name="header">Documento</f:facet>
                                            <h:outputText rendered="#{item.tipoGeneral == 'PE'}" value="#{item.dni}" />
                                            <h:outputText rendered="#{item.tipoGeneral != 'PE'}" value="#{item.ruc}" />
                                        </h:column>
                                        <h:column>
                                            <f:facet name="header">Tipo</f:facet>
                                            <h:outputText rendered="#{item.tipoGeneral == 'PE'}" value="Población" />
                                            <h:outputText rendered="#{item.tipoGeneral == 'EM'}" value="Organización / empresa" />
                                            <h:outputText rendered="#{item.tipoGeneral == 'EN'}" value="Entidad estatal" />
                                        </h:column>
                                        <h:column>
                                            <f:facet name="header"></f:facet>
                                            <a jsf:action="#{reporteSimcoController.setearActor(item)}">
                                                <span class="glyphicon glyphicon-edit" style="font-size:medium"/>
                                            </a>
                                        </h:column>
                                    </h:dataTable>
                                    <ul class="pager">
                                        <li>
                                            <a jsf:rendered="#{actorController.listaActorBusquedaGeneral.size() > 0}" jsf:action="#{actorController.buscarActorXnombrePaginado(actorController.nroPagina -1)}">Anterior
                                                <f:ajax render="idPanelModalActor" />
                                            </a>
                                        </li>
                                        <li>
                                            <a jsf:rendered="#{actorController.listaActorBusquedaGeneral.size() > 0}" jsf:action="#{actorController.buscarActorXnombrePaginado(actorController.nroPagina +1)}">Siguiente
                                                <f:ajax render="idPanelModalActor" />
                                            </a>
                                        </li>
                                    </ul>
                                </h:panelGroup>
                            </div>
                        </div>
                    </div>
                </div>
                <script>
                    function openModalBusquedaActor() {
                        $("#idModalBusquedaActor").modal('show');
                    }
                </script>
                        </div>
                        </div>
            </h:form>
        </ui:define>
    </ui:composition>
</html>